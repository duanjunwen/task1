 torchrun --nproc_per_node 8 test_dist.py -b 2M -e 256M -f 2
[2024-02-26 18:22:22,112] torch.distributed.run: [WARNING] 
[2024-02-26 18:22:22,112] torch.distributed.run: [WARNING] *****************************************
[2024-02-26 18:22:22,112] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-02-26 18:22:22,112] torch.distributed.run: [WARNING] *****************************************
+-----------+-----------------+---------------+----------+-------------+-------------+
|  size(B)  | count(elements) |      type     | time(ms) | algbw(GB/s) | busbw(GB/s) |
+-----------+-----------------+---------------+----------+-------------+-------------+
|  2097152  |      524288     | torch.float32 |   0.07   |    28.51    |    49.89    |
|  4194304  |     1048576     | torch.float32 |   0.09   |    45.26    |    79.21    |
|  8388608  |     2097152     | torch.float32 |   0.13   |    61.82    |    108.18   |
|  16777216 |     4194304     | torch.float32 |   0.21   |    74.87    |    131.03   |
|  33554432 |     8388608     | torch.float32 |   0.36   |    85.79    |    150.13   |
|  67108864 |     16777216    | torch.float32 |   0.63   |    99.21    |    173.63   |
| 134217728 |     33554432    | torch.float32 |   1.18   |    105.94   |    185.40   |
| 268435456 |     67108864    | torch.float32 |   3.02   |    82.84    |    144.97   |
+-----------+-----------------+---------------+----------+-------------+-------------+
Average busbw: 127.804 GB/s
